<!DOCTYPE html>
<!--[if IE 8]> 				 <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->

<head>
	<meta charset="utf-8" />
  <meta name="viewport" content="width=device-width" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <title>Undian Koperasi</title>

  <link rel="stylesheet" href="css/normalize.css" />
  <link rel="stylesheet" href="css/foundation.css" />
  <script src="js/vendor/custom.modernizr.js"></script>
  <script src="js/jquery-latest.min.js"></script>

<style>
#values { position:relative;font-size:400%;text-align:center;margin: 0 auto;z-index:0; }
.name { overflow:hidden;display:block; }
#names { display:none;padding:5px; }
#namesbox { min-height:400px;font-size:20px;color:#333;resize:none;border:1px solid #F39C12; }
.extra { font-size:16px;margin-top:20px; }
#winnerbox { min-height:600px;font-size:32px;color:#333;resize:none;border:1px solid #F39C12; }
#result1 { background:#000;color:#fbe34b;padding:20px;z-index:10;margin-top:-150px; }
body { background:#F1C40F url(img/bg-noise-orange.png); }
#varnote { font-size:40px;text-align:center;padding:30px; }
.copyright { font-size:11px;font-family:Tahoma;color:#9B59B6; }
table {
  font-family: arial, sans-serif;
  border-collapse: collapse;
  width: 100%;
}

td, th {
  border: 1px solid #dddddd;
  text-align: left;
  padding: 8px;
}

tr:nth-child(even) {
  background-color: #dddddd;
}
</style>

</head>
<body onload="reset();">

  <div class="full-head" style="width:100%;background:#111 url(img/header-bg.png) repeat-x center top;border-bottom:1px solid #D35400;">
	<div class="row">
		<div class="large-12 columns" style="padding-top:50px;background:#111 url(img/header-bg.png) repeat-x center top;z-index:20;">
		<ul class="button-group even-4">
      <!--<li><a href="index.html" class="alert button" id="reset">Reset</a></li>-->
			<li><button class="button" id="list" onclick="namelist();">Daftar Nama</button></li>
			<!--<li><button class="button" id="save" onclick="save();">Save &amp; Update</button></li>-->
			<li><button class="button" id="price" onclick="hadiahlist();">Daftar Hadiah</button></li>
			<!-- <li><button class="success button" id="go" onclick="go();">Mulai!</button></li> -->
			<li><button class="button" id="pemenang" onclick="pemenang();">Undian</button></li>
    </ul>
		</div>
	</div>
	</div>

	<div class="row">
		<div class="large-12 columns">
			<h3 style="text-align:center;margin-top:30px;" id="headline">Let's see who is The Lucky One?</h3>
      <button type="button" id="print" style="display: none;" onclick="doPrint()">PRINT BUOSSSSSHHHHHHH!</button>
			
			<div id="varnote"><img src="img/logo.png"><div class="copyright">&copy; Coded by <strong>Heiswayi Nrird</strong>, June 2013</div></div>
			
      <div id="popdown">
        <div id="names" class="inbox"><textarea name="namesbox" id="namesbox"></textarea></div>


          <!-- <div id="winner" class="inbox"><textarea name="winnerbox" id="winnerbox"></textarea></div> -->
          <div id="winner" class="inbox">
            <table id="winnerTable">
              <tr>
                <th style="width:47%">Anggota</th>
                <th style="width:47%">Hadiah</th>
                <th style="width:6%">Aksi</th>
              </tr>
              
            </table>
          </div>


          <select name="prizes" id="prizes" style="margin-top:30px">
            <option value="Sepeda Motor Honda Beat">Sepeda Motor Honda Beat</option>
            <option value="Sepeda I">Sepeda I</option>
            <option value="Sepeda II">Sepeda II</option>
            <option value="Sepeda III">Sepeda III</option>
            <option value="Kulkas">Kulkas</option>
            <option value="TV LED">TV LED</option>
            <option value="Line">============</option>
            <option value="Kompor Gas">Kompor Gas</option>
            <option value="Magic Com">Magic Com</option>
            <option value="Kipas Angin">Kipas Angin</option>
          </select>

          <center style="margin-top:10px"><button class="success button" style="width:600px" id="go" onclick="go();">Mulai!</button></center>

      </div> <!--popdown-->

      
      <div id="values"></div>


		</div>
	</div>

  <script>
  document.write('<script src=' +
  ('__proto__' in {} ? 'js/vendor/zepto' : 'js/vendor/jquery') +
  '.js><\/script>')
  </script>
  
  <script src="js/foundation.min.js"></script>
  <script>$(document).foundation();</script>
  
<script>
var text;
var names = new Array('Barbara McFell',
                      'Tempo McKeteketly',
                      'Maonga Irpaae',
                      'Jose Tunisia',
                      'Bob Bobson',
                      'Harold Greenoff',
                      'Jeff Penn',
                      'Ewan Freedom',
                      'Benjamin Turkin',
                      'Robert Harper',
                      'Sally Cladwell',
                      'Gregory Tomson',
                      'Benita Dano',
                      'Tameka Chea',
                      'Fernando Guntrum',
                      'Cody Devita',
                      'Margery Moloney',
                      'Jessie Wagar',
                      'Jessie Burkhard',
                      'Cody Lamotte',
                      'Tabatha Cantley',
                      'Hugh Fullwood',
                      'Emilia Janusz',
                      'Erik Taketa',
                      'Lenore Laughter',
                      'Kathrine Palazzo',
                      'Lonnie Garron',
                      'Tyrone Shott',
                      'Gay Duble',
                      'Pearlie Newberg',
                      'Clinton Rayl',
                      'Louisa Strey',
                      'Saundra Ingenito',
                      'Fernando Jenkin',
                      'Maricela Tonkin',
                      'Allie Borjas',
                      'Clinton Rickenbacker',
                      'Cody Golay',
                      'Jerri Tienda',
                      'Nita Pippen',
                      'Alejandra Bonhomme',
                      'Nelson Eguia',
                      'Rae Velasques',
                      'Boyce Edeker',
                      'Cedrick Culotti',
                      'Elenora Nagindas',
                      'Arletta Miran',
                      'Alica Knudsvig',
                      'Von Ostroot',
                      'Tomika Nuesca',
                      'Felton Pattinson',
                      'Cristopher Laper',
                      'Shonna Parrotta',
                      'Sarina Macurdy',
                      'Waylon Companie',
                      'Shon Carratura',
                      'Jae Kneser',
                      'Janett Papiernik',
                      'Lynwood Bellar',
                      'Jeramy Contopoulos',
                      'Hong Nederostek',
                      'Gigi Mccarn',
                      'Sid Mursko',
                      'Bielser',
                      'Jospeh Lustberg',
                      'Spring Luckinbill',
                      'Ciera Chionchio',
                      'Marleen Litchard',
                      'Eldridge Brynga',
                      'Leif Dinho',
                      'Gigi Kornblatt',
                      'Idell Chagollan',
                      'Michale Mcclod'
                      );

var winnerList = new Array();

function reset(){
  // re-enable go button
  setTimeout("$('#go').removeAttr('disabled')",11005);
  var namesbreak = "";
  if(gup('names') != ""){
    var names = gup('names');
    namesbreak = names.replace(/101/g,'\n');
    namesbreak = namesbreak.replace(/%20/g,' ');          
    }
    else   {
      var names = new Array('Barbara McFell',
                      'Tempo McKeteketly',
                      'Maonga Irpaae',
                      'Jose Tunisia',
                      'Bob Bobson',
                      'Harold Greenoff',
                      'Jeff Penn',
                      'Ewan Freedom',
                      'Benjamin Turkin',
                      'Robert Harper',
                      'Sally Cladwell',
                      'Gregory Tomson',
                      'Benita Dano',
                      'Tameka Chea',
                      'Fernando Guntrum',
                      'Cody Devita',
                      'Margery Moloney',
                      'Jessie Wagar',
                      'Jessie Burkhard',
                      'Cody Lamotte',
                      'Tabatha Cantley',
                      'Hugh Fullwood',
                      'Emilia Janusz',
                      'Erik Taketa',
                      'Lenore Laughter',
                      'Kathrine Palazzo',
                      'Lonnie Garron',
                      'Tyrone Shott',
                      'Gay Duble',
                      'Pearlie Newberg',
                      'Clinton Rayl',
                      'Louisa Strey',
                      'Saundra Ingenito',
                      'Fernando Jenkin',
                      'Maricela Tonkin',
                      'Allie Borjas',
                      'Clinton Rickenbacker',
                      'Cody Golay',
                      'Jerri Tienda',
                      'Nita Pippen',
                      'Alejandra Bonhomme',
                      'Nelson Eguia',
                      'Rae Velasques',
                      'Boyce Edeker',
                      'Cedrick Culotti',
                      'Elenora Nagindas',
                      'Arletta Miran',
                      'Alica Knudsvig',
                      'Von Ostroot',
                      'Tomika Nuesca',
                      'Felton Pattinson',
                      'Cristopher Laper',
                      'Shonna Parrotta',
                      'Sarina Macurdy',
                      'Waylon Companie',
                      'Shon Carratura',
                      'Jae Kneser',
                      'Janett Papiernik',
                      'Lynwood Bellar',
                      'Jeramy Contopoulos',
                      'Hong Nederostek',
                      'Gigi Mccarn',
                      'Sid Mursko',
                      'Bielser',
                      'Jospeh Lustberg',
                      'Spring Luckinbill',
                      'Ciera Chionchio',
                      'Marleen Litchard',
                      'Eldridge Brynga',
                      'Leif Dinho',
                      'Gigi Kornblatt',
                      'Idell Chagollan',
                      'Michale Mcclod'
                      );
    for(var i in names){
      name = names[i];
      if (name == "" || typeof(name) == undefined){}else{
         namesbreak = namesbreak + name + "\n";
      }
    }
  }
  $("#namesbox").val(namesbreak);
}

function gup(para)
{
  para = para.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
  var regexS = "[\\?&]"+para+"=([^&#]*)";
  var regex = new RegExp( regexS );
  var results = regex.exec( window.location.href );
  if( results == null )
    return "";
  else
    return results[1];
}

function randOrd(){
	return (Math.round(Math.random())-0.5); 
}

function save(){
        $("#varnote").hide();
        $("#popdown").show();
        $("#values").hide();
        $("div").remove("#result1");
        savenames = $("#namesbox").val();
        savenames = savenames.replace(/\n\r?/g, '101');
        $('#headline').fadeOut();
        $('#headline').text('The name list is saved and updated.').fadeIn();
        $("#names").show();
        $('#namesbox').attr('disabled','disabled');

        $("#print").hide();
}

function namelist(){
        $("#varnote").hide();
        $('#namesbox').removeAttr('disabled','disabled');
        $('#headline').text('Configure name list');
        $("#popdown").show();
        $("#values").hide();
        $("#names").show();
        $("#prizes").hide();
        $("#winner").hide();
        $('body').css({"overflow-y": "visible"});

        $("#print").hide();
}
function hadiahlist(){
        $("#varnote").hide();
        $('#namesbox').removeAttr('disabled','disabled');
        $('#headline').text('Pilih Hadiah');
        $("#popdown").show();
        $("#values").hide();
        $("#prizes").show();
        $("#names").hide();
        $("#winner").hide();
        $('body').css({"overflow-y": "visible"});

        $("#print").hide();
}
function pemenang(){
        $("#varnote").hide();
        $('#namesbox').removeAttr('disabled','disabled');
        $('#headline').text('Daftar Pemenang');
        $("#popdown").show();
        $("#values").hide();
        $("#prizes").show();
        $("#names").hide();
        $("#winner").show();
        $('body').css({"overflow-y": "visible"});

        $("#print").show();
}

function doPrint(){
  w=window.open();
  w.document.write($("#winner").html());
  w.print();
  w.close();
}

// does the actual animation
function go(){
  $("#varnote").hide();
  $('body').css({"overflow-y": "hidden"});
  $('#go').attr('disabled','disabled');
  $('#list').attr('disabled','disabled');
  $('#save').attr('disabled','disabled');
  $('#headline').slideUp();
  $('#namesbox').slideDown();

  $("#print").hide();

  var count = 1;
  count = 1;
  $("div").remove("#result1");
  names = $("#namesbox").val();
  if(document.all) { // IE
    names=names.split("\n");
  }
  else { //Mozilla
    names=names.split("\n");
  }
  $("#values").show();
  $(".name").show();
  $("#popdown").hide();
  $("div").remove(".name");
  $("div").remove(".extra");
  $("#playback").html("");
  newtop = names.length * 200 * -1;
  //$('#values').css({top: -300});
  $('#values').css({top: + newtop});	
  names.sort( randOrd );
  var fruits = new Array ( "apple", "pear", "orange", "banana" );
  //console.log(fruits);
  //console.log(names);
  //alert(newtop);
  for(var i in names){
    if (names[i] == "" || typeof(names[i]) == undefined){
      count = count-1;
    } else {
      name = names[i];
      //console.log(name);
      $('#values').append('<div id=result'+count+' class=name>'+name+'</div>');
    }
    count = count+1;
  }
  for(var i in names){
    if (names[i] == "" || typeof(names[i]) == undefined){}else{
      name = names[i];
      $('#values').append('<div class=name>'+name+'</div>');
    }
    count = count+1;
  }
  for(var i in names){
    if (names[i] == "" || typeof(names[i]) == undefined){}else{
      name = names[i];
      $('#values').append('<div class=name>'+name+'</div>');
    }
    count = count+1;
  }
  text = $('#result1').text()
  $('#values').animate({top: '+176'},5000);

  // make it stand out
  setTimeout("standout(text)",5000);
  //setTimeout("$('#playback').hide('slow')",11005);
}

function standout(text){

        $('#result1').removeClass('name');
        $('.name').animate({opacity: .25});
        $('#result1').animate({height: '+=130px'});
        $('#result1').append('<div class="extra"><a class="small alert button" href="#" onClick="removevictim();">Hapus</a></div>');
        $('#go').removeAttr('disabled','disabled');
        $('#list').removeAttr('disabled','disabled');
        $('#save').removeAttr('disabled','disabled');
        $('#headline').text('Pemenang Hadiah ' + $('#prizes').find(":selected").text() + "!");
        $('#headline').slideDown();

        addToWinnerList();
}

function removevictim(){
	// Removing victim from array and UI
	// names = names.filter(function(){ return true});
	// Rewriting namesbox contents
	var nameupdated = "";
	for(var i in names){
		name = names[i];
                if (name == "" || name == text || typeof(name) == undefined){}else{
			nameupdated = nameupdated + "\n" + name;
		}
	}
	$('#namesbox').val("");
  $('#namesbox').val(nameupdated);
  $('#result1').html("Removed");
  $('#result1').fadeOut(1000, function(){
    $("div").remove("#result1");
  });
  $("div").remove(".name");
  $("div").remove(".extra");
  $('#headline').text('OK, done! Let\'s see who is next? Just click "GO!" button for next roll.');

  //addToWinnerList();
  console.log("test");
  pemenang();
}

function addToWinnerListText(){
	// Removing victim from array and UI
	// names = names.filter(function(){ return true});
  // Rewriting namesbox contents
  
  winnerList = $("#winnerbox").val();

	var winnerUpdated = winnerList + "\n" + text + '\nMendapatkan 1 buah ' + $('#prizes').find(":selected").text() + '\n';
  
	$('#winnerbox').val("");
  $('#winnerbox').val(winnerUpdated);
  //$('#result1').html("Removed");
  //$('#result1').fadeOut(1000, function(){
  //  $("div").remove("#result1");
  //});
  //$("div").remove(".name");
  //$("div").remove(".extra");
  //$('#headline').text( $('#headline').text() + '\nAdded to winner list.');
}

function addToWinnerList(){
  winnerList.pop({
    'name' : text,
    'prize' : $('#prizes').find(":selected").text()
  });

  console.log(winnerList);
  renderTable(text, $('#prizes').find(":selected").text());
}

function renderTable(nama, hadiah){
  var table = document.getElementById("winnerTable");
  var row = table.insertRow(1);
  var cell1 = row.insertCell(0);
  var cell2 = row.insertCell(1);
  var cell3 = row.insertCell(2);
  cell1.innerHTML = nama;
  cell2.innerHTML = hadiah;
  cell3.innerHTML = '<button onclick="deleteWinner()"><i class="fa fa-trash"></i></button>';
}

function deleteWinner(index){
  winnerList.splice(index, 1);
  var table = document.getElementById("winnerTable");
  table.deleteRow(index);
}

</script>



</body>
</html>
